<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Python Learner — By Rony Nayak</title>

<!-- Monaco loader -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.45.0/min/vs/loader.min.js"></script>

<!-- Pyodide -->
<script src="https://cdn.jsdelivr.net/pyodide/v0.26.2/full/pyodide.js"></script>

<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#0b0f14;
  --panel:#0f1720;
  --muted:#9fb;
  --accent:#5865f2;
  --card:#0e1620;
  --mono: "JetBrains Mono", "Courier New", monospace;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:Inter,system-ui,Arial;background:var(--bg);color:#e6eef8}
.topbar{height:60px;display:flex;align-items:center;justify-content:space-between;padding:0 20px;background:#071428;position:sticky;top:0;z-index:90}
.brand{font-weight:700;font-size:18px}
.container{display:flex;height:calc(100vh - 60px);overflow:hidden}

/* Left sidebar */
.sidebar{width:350px;flex:0 0 350px;background:linear-gradient(180deg,#071017,#0b0b0b);padding:18px;overflow:auto;border-right:2px solid rgba(88,101,242,0.14)}
.sidebar h3{margin:6px 0;color:#cfe}
.progress-wrap{margin:10px 0}
.progress-bar{background:rgba(255,255,255,0.04);height:8px;border-radius:8px;overflow:hidden}
.progress-fill{height:100%;background:var(--accent);width:0%}
.topic-list{margin-top:14px;display:flex;flex-direction:column;gap:8px}
.topic{padding:12px;background:rgba(255,255,255,0.02);border-radius:8px;cursor:pointer}
.topic.locked{opacity:0.5;cursor:not-allowed}
.topic.active{background:rgba(88,101,242,0.18)}

/* Middle lesson description */
.lesson{width:33%;min-width:320px;padding:22px;overflow:auto;background:linear-gradient(180deg,#071017,#071017)}
.lesson .title{font-size:20px;font-weight:700;margin-bottom:8px}
.lesson .body{color:#dfeefb;line-height:1.6}
.lesson .example{background:#0b1220;padding:12px;border-radius:8px;margin-top:12px;font-family:var(--mono);white-space:pre-wrap;color:#dfeefb}
.lesson .nav{display:flex;justify-content:space-between;margin-top:14px;gap:8px}
.btn{background:var(--accent);border:none;color:#fff;padding:8px 12px;border-radius:8px;cursor:pointer;font-weight:700}
.btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06)}

/* Right: editor + output */
.editor-panel{flex:1;display:flex;flex-direction:column;border-left:2px solid rgba(88,101,242,0.12);background:var(--panel)}
.editor-header{display:flex;align-items:center;justify-content:space-between;padding:10px 14px;border-bottom:1px solid rgba(255,255,255,0.03)}
.editor-actions{display:flex;gap:10px;align-items:center}
select.lang{background:#0b0b0b;color:#fff;border:1px solid #222;padding:8px;border-radius:6px}
#runBtn{background:var(--accent);border:none;color:#fff;padding:8px 12px;border-radius:8px;cursor:pointer;font-weight:700}
#editor{height:calc(100vh - 260px);width:100%}
.output-tabs{display:flex;border-top:1px solid rgba(255,255,255,0.03);background:#0b0b0b}
.tab{padding:12px 16px;cursor:pointer;border-right:1px solid rgba(255,255,255,0.02)}
.tab.active{background:#0d1116}
.output{height:240px;background:#000;padding:12px;overflow:auto;font-family:var(--mono);color:#cfe;border-top:2px solid rgba(88,101,242,0.12)}

/* input bar (terminal style) */
.input-bar{display:flex;gap:8px;padding:10px;border-top:1px solid rgba(255,255,255,0.03);background:#070707}
.input-field{flex:1;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:#0b0b0b;color:#fff;font-family:var(--mono)}

/* responsive */
@media(max-width:1000px){
  .container{flex-direction:column}
  .sidebar{width:100%;flex:0 0 auto;border-right:none;border-bottom:2px solid rgba(88,101,242,0.08)}
  .lesson{width:100%;order:2}
  .editor-panel{order:3;height:55vh}
  #editor{height:calc(55vh - 150px)}
  .output{height:18vh}
}
</style>
</head>
<body>
  <div class="topbar">
    <div class="brand">Python Learner — By Rony Nayak</div>
    <div style="display:flex;gap:10px;align-items:center">
      <button class="btn ghost" id="coursesBtn">Courses</button>
      <button class="btn ghost" id="practiceBtn">Practice</button>
      <button class="btn ghost" id="signinBtn">Sign in</button>
    </div>
  </div>

  <div class="container">
    <div class="sidebar" id="sidebar">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div style="font-weight:700">Complete Python — From Basics to Advanced</div>
        <div style="text-align:right;color:#9fb">Progress: <span id="progPct">0%</span></div>
      </div>

      <div class="progress-wrap">
        <div class="progress-bar"><div class="progress-fill" id="progFill"></div></div>
      </div>

      <div style="font-weight:700;margin-top:6px;color:#cfe">Topics</div>
      <div class="topic-list" id="topicList"></div>

      <div style="margin-top:18px">
        <div style="font-weight:700;color:#cfe">Course Info</div>
        <div style="background:var(--card);padding:12px;border-radius:8px;margin-top:8px">
          <div style="font-weight:700">Duration</div>
          <div style="color:#cfe">40–70 hours (self paced)</div>
          <hr style="opacity:0.06;margin:8px 0">
          <div style="font-weight:700">Goal</div>
          <div style="color:#cfe">Learn Python basics to advanced with interactive examples</div>
        </div>
      </div>
    </div>

    <div class="lesson" id="lesson">
      <div class="title" id="lessonTitle">Welcome to Python</div>
      <div class="body" id="lessonBody">
        <p>Choose a topic from the left to begin. Each lesson has explanation, example and an editable practice code on the right.</p>
      </div>
      <div class="example" id="lessonExample"># Examples will appear here</div>

      <div class="nav" style="margin-top:18px">
        <button class="btn ghost" id="prevLesson">Previous</button>
        <div style="display:flex;gap:8px">
          <button class="btn ghost" id="hintBtn" style="display:none">Hint</button>
          <button class="btn" id="nextLesson">Next</button>
        </div>
      </div>
    </div>

    <div class="editor-panel">
      <div class="editor-header">
        <div style="display:flex;align-items:center;gap:10px">
          <select class="lang" id="langSelect"><option value="python">Python</option></select>
          <button class="btn ghost" id="resetBtn">Reset</button>
        </div>

        <div class="editor-actions">
          <button id="runBtn">▶ Run</button>
        </div>
      </div>

      <div id="editor"></div>

      <div class="output-tabs">
        <div class="tab active" data-tab="output">Output</div>
      </div>

      <div class="output" id="output">Console output will appear here...</div>

      <div class="input-bar" id="inputBar" style="display:none">
        <input id="inputField" class="input-field" placeholder="Type input and press Enter" />
        <button class="btn" id="inputSend">Enter</button>
      </div>
    </div>
  </div>

<!-- Script: initialize Monaco + Pyodide + UI -->
<script>
/* ---------- Lessons content (complete syllabus simplified) ---------- */
const LESSONS = [
  {id:1, title:'Introduction to Python', body:`Python is a high-level, interpreted language used for web development, data science, automation and more. This course will teach you from basics to advanced.`, example:`# Hello World\nprint("Hello, world!")`, hint:'Run the example.'},
  {id:2, title:'Variables & Data Types', body:`Variables store values. Common types: int, float, str, bool.`, example:`x = 10\npi = 3.14\nname = "Rony"\nprint(type(x), type(pi), type(name))`, hint:'Use type() to inspect types.'},
  {id:3, title:'Input & Type Conversion', body:`input() reads text from user. Convert using int(), float().`, example:`age = int(input("Enter your age: "))\nprint("Next year:", age+1)`, hint:'Wrap in try/except for safety.'},
  {id:4, title:'Operators & Expressions', body:`Arithmetic: + - * / // % ; comparison: == != > < ; logical: and/or/not`, example:`a=7; b=3\nprint(a/b, a//b, a%b)`, hint:'Use parentheses to force order.'},
  {id:5, title:'Strings & Methods', body:`Strings are sequences. Use methods like .upper(), .lower(), .split(), .replace()`, example:`s = "hello Rony"\nprint(s.upper())\nprint(s.split())`, hint:'Try f-strings for formatting.'},
  {id:6, title:'If, Elif & Else', body:`Conditional logic controls program flow. Indentation is significant in Python.`, example:`n = int(input("n: "))\nif n>0:\n  print("Positive")\nelif n==0:\n  print("Zero")\nelse:\n  print("Negative")`, hint:'Indentation matters.'},
  {id:7, title:'For Loops & range()', body:`for loops iterate over sequences. range(start,stop,step).`, example:`for i in range(1,6):\n  print(i)`, hint:'range(5) -> 0..4.'},
  {id:8, title:'While Loops & Loop Control', body:`while loops repeat until condition false. Use break/continue.` , example:`i=0\nwhile i<5:\n  print(i)\n  i+=1`, hint:'Avoid infinite loops.'},
  {id:9, title:'Functions', body:`Functions are defined using def. Use parameters and return values.`, example:`def add(a,b):\n  return a+b\nprint(add(2,3))`, hint:'Keep functions focused.'},
  {id:10, title:'Lists', body:`Lists are ordered, mutable sequences. Use append, pop, slicing.`, example:`lst=[1,2,3]\nlst.append(4)\nprint(lst[1:3])`, hint:'Use list comprehensions.'},
  {id:11, title:'Tuples', body:`Tuples are immutable sequences.` , example:`t=(1,2,3)\n# t[0]=5 -> error`, hint:'Good for fixed data.'},
  {id:12, title:'Dictionaries', body:`Key-value store. Use d[key] or d.get(key).`, example:`d={'a':1,'b':2}\nfor k,v in d.items():\n  print(k,v)`, hint:'Use get() to avoid KeyError.'},
  {id:13, title:'Sets', body:`Unordered unique elements. Good for deduplication.`, example:`s=set([1,2,2,3])\nprint(s)`, hint:'Fast membership tests.'},
  {id:14, title:'Comprehensions', body:`Short ways to build lists/sets/dicts.`, example:`squares=[x*x for x in range(6)]\nprint(squares)`, hint:'Combine with if conditions.'},
  {id:15, title:'File Handling', body:`Use open(), read(), write() and with statement.`, example:`with open('data.txt','w') as f:\n  f.write('hello')`, hint:'Use with to auto-close files.'},
  {id:16, title:'Exceptions', body:`Handle errors using try/except/finally.`, example:`try:\n  x=int(input())\nexcept ValueError:\n  print('Invalid')`, hint:'Catch specific exceptions.'},
  {id:17, title:'Modules & Packages', body:`Organize code into modules. Use import.`, example:`import math\nprint(math.sqrt(16))`, hint:'Use virtualenv for projects.'},
  {id:18, title:'Standard Library', body:`Explore os, sys, json, datetime, random.`, example:`import json\nprint(json.dumps({'a':1}))`, hint:'Read docs.'},
  {id:19, title:'OOP Basics', body:`Classes, objects, __init__, self.`, example:`class Person:\n  def __init__(self,name):\n    self.name=name\np=Person('Rony')\nprint(p.name)`, hint:'Prefer composition.'},
  {id:20, title:'Advanced OOP', body:`Magic methods, dataclasses.`, example:`from dataclasses import dataclass\n@dataclass\nclass P:\n  name:str\n  age:int`, hint:'Dataclasses reduce boilerplate.'},
  {id:21, title:'Iterators & Generators', body:`Use yield to create generators.`, example:`def gen(n):\n  for i in range(n):\n    yield i`, hint:'Memory efficient.'},
  {id:22, title:'Decorators', body:`Wrap functions to add behavior.`, example:`def debug(f):\n  def inner(*a,**k):\n    print('call',f.__name__)\n    return f(*a,**k)\n  return inner`, hint:'Common in frameworks.'},
  {id:23, title:'Lambda & Functional', body:`lambda, map, filter, functools.reduce.`, example:`s=list(map(lambda x:x*2,[1,2,3]))\nprint(s)`, hint:'Use for small functions.'},
  {id:24, title:'Testing', body:`Use unittest/pytest; write asserts.`, example:`assert 1+1==2`, hint:'Test edge cases.'},
  {id:25, title:'Working with APIs', body:`Use requests to call APIs (install packages).`, example:`# pip install requests\nimport requests\nr=requests.get('https://api.github.com')\nprint(r.status_code)`, hint:'Handle network errors.'},
  {id:26, title:'Web Basics (Flask)', body:`Intro to building simple web apps using Flask.`, example:`# flask app placeholder`, hint:'Deploy on Heroku / Vercel.'},
  {id:27, title:'Data Basics', body:`Intro to numpy/pandas (overview).`, example:`# overview placeholder`, hint:'Learn more for data science.'},
  {id:28, title:'Mini Projects', body:`Ideas: Calculator, Todo, Guessing game, Scraper.`, example:`# project placeholder`, hint:'Build and publish projects.'},
  {id:29, title:'Debugging & Logging', body:`Use logging module and pdb for debugging.`, example:`import logging\nlogging.info('msg')`, hint:'Logs help in production.'},
  {id:30, title:'Final Steps & Next Learning', body:`Tips to continue: build projects, read docs, contribute to open-source.`, example:`# final note`, hint:'Keep practicing.'},
];

/* ---------- UI init ---------- */
const topicListEl = document.getElementById('topicList');
const lessonTitleEl = document.getElementById('lessonTitle');
const lessonBodyEl = document.getElementById('lessonBody');
const lessonExampleEl = document.getElementById('lessonExample');
const progFill = document.getElementById('progFill');
const progPct = document.getElementById('progPct');
const nextBtn = document.getElementById('nextLesson');
const prevBtn = document.getElementById('prevLesson');
const hintBtn = document.getElementById('hintBtn');
const resetBtn = document.getElementById('resetBtn');

let progress = JSON.parse(localStorage.getItem('plr_progress')||'{}');
let currentLesson = Number(localStorage.getItem('plr_current')||1);

function isUnlocked(id){ if(id===1) return true; return !!progress[id-1]; }

function renderTopics(){
  topicListEl.innerHTML='';
  LESSONS.forEach(l=>{
    const div = document.createElement('div');
    div.className='topic';
    if(!isUnlocked(l.id)) div.classList.add('locked');
    if(l.id===currentLesson) div.classList.add('active');
    div.innerText = l.id + '. ' + l.title;
    div.onclick = ()=>{ if(isUnlocked(l.id)){ openLesson(l.id);} else { alert('Complete previous lessons to unlock this.'); } };
    topicListEl.appendChild(div);
  });
}

function updateProgressUI(){
  const done = Object.keys(progress).length;
  const total = LESSONS.length;
  const pct = Math.round(done/total*100);
  progFill.style.width = pct+'%';
  progPct.innerText = pct + '%';
}

function openLesson(id){
  currentLesson = id;
  localStorage.setItem('plr_current', currentLesson);
  const l = LESSONS.find(x=>x.id===id);
  lessonTitleEl.innerText = l.title;
  lessonBodyEl.innerHTML = '<p>'+String(l.body).replace(/\n\n/g,'</p><p>').replace(/\n/g,'<br>')+'</p>';
  lessonExampleEl.innerText = l.example||'';
  hintBtn.style.display = l.hint ? 'inline-block' : 'none';
  if(l.example && l.example.trim()){ if(window.editor) editor.setValue(l.example); localStorage.setItem('plr_code', editor && editor.getValue ? editor.getValue() : ''); }
  renderTopics();
  updateProgressUI();
}

prevBtn.onclick = ()=>{ if(currentLesson>1) openLesson(currentLesson-1); };
nextBtn.onclick = ()=>{
  progress[currentLesson]=true;
  localStorage.setItem('plr_progress', JSON.stringify(progress));
  if(currentLesson<LESSONS.length) openLesson(currentLesson+1);
  renderTopics();
  updateProgressUI();
};
hintBtn.onclick = ()=>{ const l = LESSONS.find(x=>x.id===currentLesson); if(l && l.hint) alert('Hint:\n'+l.hint); };

renderTopics();

/* ---------- Monaco editor init ---------- */
let editor;
require.config({ paths: { vs: 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.45.0/min/vs' }});
require(['vs/editor/editor.main'], function () {
  editor = monaco.editor.create(document.getElementById('editor'), {
    value: '# Write Python code here\\nprint(\"Hello from Python Learner\")',
    language: 'python',
    theme: 'vs-dark',
    automaticLayout: true,
    minimap: { enabled: false },
    fontFamily: 'JetBrains Mono, monospace',
    fontSize: 14,
    tabSize: 4,
    insertSpaces: true,
  });

  // load last saved code
  const saved = localStorage.getItem('plr_code');
  if(saved) editor.setValue(saved);
  editor.onDidChangeModelContent(()=> localStorage.setItem('plr_code', editor.getValue()));

  // open the saved/current lesson
  openLesson(currentLesson);
});

/* ---------- Pyodide setup (real Python) ---------- */

let pyodide = null;
let pyodideReady = false;
let inputQueue = [];
let waitingForInput = false;

async function initPyodide(){
  const outputEl = document.getElementById('output');
  outputEl.innerText = '⏳ Loading Python interpreter...';
  pyodide = await loadPyodide({indexURL: "https://cdn.jsdelivr.net/pyodide/v0.26.2/full/"});
  // define JS synchronous input function accessible from Python via js._get_input
  window._pyodide_get_input = function(promptText){
    // try to use input queue first
    if(inputQueue.length>0){
      return inputQueue.shift();
    }
    // fallback to synchronous browser prompt (no async blocking UI here)
    // Using prompt to keep input synchronous so Python's input() works seamlessly
    const val = window.prompt(promptText ?? '');
    return val === null ? '' : val;
  };

  // in Python, we will override builtins.input to call js._pyodide_get_input
  const bootstrapInput = `
import builtins, js
def __pyodide_input(prompt=''):
    try:
        return js._pyodide_get_input(str(prompt))
    except:
        return ''
builtins.input = __pyodide_input
`;
  await pyodide.runPythonAsync(bootstrapInput);
  pyodideReady = true;
  outputEl.innerText = '✅ Python ready!';
}
initPyodide();

/* ---------- Run button logic ---------- */
document.getElementById('runBtn').addEventListener('click', async ()=>{
  const outputEl = document.getElementById('output');

  if(!pyodideReady){
    outputEl.innerText = '⏳ Python is still loading...';
    return;
  }

  outputEl.innerText = '';  // clear output

  const code = editor.getValue();

  try {
    const wrapper = `
import sys, io
buffer = io.StringIO()
sys_stdout = sys.stdout
sys_stderr = sys.stderr
sys.stdout = buffer
sys.stderr = buffer
try:
${code.split('\n').map(line=>'    '+line).join('\n')}
finally:
    sys.stdout = sys_stdout
    sys.stderr = sys_stderr

buffer.getvalue()
`;

    let result = await pyodide.runPythonAsync(wrapper);

    if (result === undefined || result === null) {
      result = buffer.getvalue() if 'buffer' in locals() else "";
    }

    outputEl.innerText = String(result).trim();

  } catch(err){
    outputEl.innerText = '❌ Error:\n' + String(err);
  }
});

/* ---------- Input support via inputBar (optional queue) ---------- */
const inputBar = document.getElementById('inputBar');
const inputField = document.getElementById('inputField');
const inputSend = document.getElementById('inputSend');

inputSend.addEventListener('click', ()=>{
  const v = inputField.value || '';
  inputQueue.push(v);
  inputField.value = '';
  inputBar.style.display = 'none';
});

// If a prompt is needed and we were to use an in-page input, user can click to open
// but current default uses browser prompt to keep synchronous compatibility

/* ---------- Reset button ---------- */
resetBtn.addEventListener('click', ()=>{
  const l = LESSONS.find(x=>x.id===currentLesson);
  if(l && l.example) editor.setValue(l.example);
});

/* ---------- Small helpers ---------- */
window.PLR = {
  resetProgress: () => {
    if(confirm('Reset progress?')){
      progress = {};
      localStorage.removeItem('plr_progress');
      localStorage.removeItem('plr_current');
      location.reload();
    }
  }
};

/* ---------- Ensure layout and initial load ---------- */
window.addEventListener('resize', ()=>{ if(editor) editor.layout(); });
</script>
</body>
</html>
